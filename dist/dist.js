document.addEventListener("DOMContentLoaded",(function(){const e=CodeMirror.modeInfo.reduce((function(e,n){return e[n.mode]?e[n.mode].push(n):e[n.mode]=[n],e}),{}),n=CodeMirror.modeInfo.reduce((function(e,n){return e[n.name]={mode:n.mode,mime:n.mime},e}),{}),t=Object.keys(n);let o,a,i,d,m,u,r,s=!1,c=!0;function l(){if(a){let e=a;o.saveItemWithPresave(e,(()=>{d=u.getValue(),e.content.text=d,e.clientData=i,e.content.preview_plain=null,e.content.preview_html=null}))}}function f(o){if(!o)return;const a=function(t){const o=function(e){return e?{name:e.name,mode:e.mode,mime:e.mime}:null},a=/.+\.([^.]+)$/.exec(t),i=/\//.test(t);if(a)return o(CodeMirror.findModeByExtension(a[1]));if(i)return o(CodeMirror.findModeByMIME(i[1]));if(n[t])return{name:t,mode:n[t].mode,mime:n[t].mime};if(e[t]){const n=e[t][0];return{name:n.name,mode:n.mode,mime:n.mime}}return{name:t,mode:t,mime:t}}(o);a?(u.setOption("mode",a.mime),CodeMirror.autoLoadMode(u,a.mode),i&&(i.mode=a.name),r.defaultValue=t.indexOf(a.name)):console.error("Could not find a mode corresponding to "+o)}function g(e){const n=document.getElementById("toggle-vim-mode-button"),t="vim"===e?"Disable":"Enable",o="vim"===e?"danger":"success";n.innerHTML=`${t} Vim mode`,n.classList.remove("danger"),n.classList.remove("success"),n.classList.add(o)}window.setKeyMap=function(e){u.setOption("keyMap",e)},window.onLanguageSelect=function(e){f(t[e]),l()},window.setDefaultLanguage=function(){const e=t[r.defaultValue];o.setComponentDataValueForKey("language",e);const n=document.getElementById("default-label"),a=n.innerHTML;n.innerHTML="Success",n.classList.add("success"),setTimeout((function(){n.classList.remove("success"),n.innerHTML=a}),750)},window.toggleVimMode=function(){let e;e="default"===(o.getComponentDataValueForKey("keyMap")??"default")?"vim":"default",window.setKeyMap(e),o.setComponentDataValueForKey("keyMap",e),g(e)},CodeMirror.commands.save=function(){l()},u=CodeMirror.fromTextArea(document.getElementById("code"),{extraKeys:{"Alt-F":"findPersistent"},lineNumbers:!0,styleSelectedText:!0,lineWrapping:!0}),u.setSize("100%","100%"),setTimeout((function(){f("JavaScript")}),1),r=document.getElementById("language-select"),r.onChange=function(e){window.onLanguageSelect(e)},r.options=t.map(((e,n)=>({value:n,label:e}))),u.on("change",(function(){s||l()})),o=new ComponentRelay({targetWindow:window,onReady:()=>{const e=o.platform;e&&document.body.classList.add(e);const n=o.getComponentDataValueForKey("keyMap")??"default";window.setKeyMap(n),g(n)}}),o.streamContextItem((e=>{!function(e){if(e.uuid!==m&&(d=null,c=!0,m=e.uuid),a=e,e.isMetadataUpdate)return;i=e.clientData;f(i.mode||o.getComponentDataValueForKey("language")),u&&(e.content.text!==d&&(s=!0,u.getDoc().setValue(a.content.text),s=!1),c&&(c=!1,u.getDoc().clearHistory()))}(e)}))}));
//# sourceMappingURL=dist.js.map